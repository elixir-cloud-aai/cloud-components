{"version":3,"file":"wesRuns.js","sourceRoot":"","sources":["../../../../../src/components/wes-runs/definition/wesRuns.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  FASTElement,\n  attr,\n  customElement,\n  observable,\n} from '@microsoft/fast-element';\nimport template from './wesRuns.template.js';\nimport styles from './wesRuns.styles.js';\nimport ApiResponse, { Run } from './types.js';\nimport { fetchWorkflows } from '../../../data/index.js';\n\n@customElement({\n  name: 'ecc-client-ga4gh-wes-runs',\n  template,\n  styles,\n})\nexport default class WESRuns extends FASTElement {\n  // Base URL, provided by app author\n  @attr baseURL = '';\n\n  // Number of Run to be listed at once\n  @attr pageSize = 5;\n\n  @observable tokens: { [page: number]: string } = {};\n\n  // Data to be rendered\n  @observable data: Run[] = [];\n\n  // First page number of every data cache\n  @observable pageNumber = 1;\n\n  // Seach input for name_prefix filter\n  @observable searchInput = '';\n\n  @observable stateInput = 'ALL';\n\n  @observable unfilterdData: ApiResponse = {\n    runs: [],\n    next_page_token: '',\n  };\n\n  @observable isLoading = true;\n\n  async connectedCallback() {\n    super.connectedCallback();\n    // Since this is the first call, fetch the first page, no token needed\n    await this.fetchData('');\n    this.tokens[1] = '';\n    this.tokens[2] = this.unfilterdData.next_page_token;\n  }\n\n  /**\n   *Fetches data of pageSize length\n   * @param token token for the next page for cache data\n   * @param namePrefix takes in the filter value for name prefix\n   */\n  fetchData = async (token: string) => {\n    this.isLoading = true;\n\n    // Reset data\n    this.data = [];\n\n    // Fetch new data\n    let newData = [];\n    newData = await fetchWorkflows(this.baseURL, this.pageSize, token);\n    if (newData && newData.runs) {\n      this.data = newData.runs;\n      this.unfilterdData = newData;\n    }\n    this.isLoading = false;\n  };\n\n  // Cache next click\n  handleNext = async () => {\n    // Reset the state filter\n    this.stateInput = 'ALL';\n\n    // Calculate the next page\n    const nextPageNumber = this.pageNumber + 1;\n    this.pageNumber = nextPageNumber; // Increment the pageNumber\n\n    // Get the next page token\n    const pageToken = this.tokens[this.pageNumber];\n\n    // Call the fetchData method with the nextPageToken and searchInput\n    await this.fetchData(pageToken as string);\n\n    // Hash the token for next of the next page\n    this.tokens[nextPageNumber + 1] = this.unfilterdData.next_page_token;\n  };\n\n  // Handle prev click\n  handlePrev = async () => {\n    this.stateInput = 'ALL';\n    const prevPageNumber = this.pageNumber - 1;\n    const prevPageToken = this.tokens[prevPageNumber];\n    await this.fetchData(prevPageToken);\n    this.pageNumber -= 1;\n  };\n\n  handleStateInput(event: Event) {\n    this.stateInput = (event.target as HTMLInputElement).value;\n\n    // Filter data on current page based on the filter input\n    if (this.stateInput === 'ALL') this.data = this.unfilterdData.runs;\n    else {\n      this.data = this.unfilterdData.runs.filter(\n        (run) => run.state === this.stateInput\n      );\n    }\n  }\n}\n"]}